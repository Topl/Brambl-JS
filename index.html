<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Brambl.html">Brambl</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Brambl.html#.Hash">Hash</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Brambl.html#.KeyManager">KeyManager</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Brambl.html#.Requests">Requests</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Brambl.html#addSigToTx">addSigToTx</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Brambl.html#pollTx">pollTx</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Brambl.html#signAndBroadcast">signAndBroadcast</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Brambl.html#transaction">transaction</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Hash.html">Hash</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Hash.html#.any">any</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Hash.html#.file">file</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Hash.html#.string">string</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="module-KeyManager-KeyManager.html">KeyManager</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Requests.html">Requests</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#broadcastTx">broadcastTx</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#createRawArbitTransfer">createRawArbitTransfer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#createRawAssetTransfer">createRawAssetTransfer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#createRawPolyTransfer">createRawPolyTransfer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#getBlockByHeight">getBlockByHeight</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#getBlockById">getBlockById</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#getLatestBlock">getLatestBlock</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#getMempool">getMempool</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#getTransactionById">getTransactionById</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#getTransactionFromMempool">getTransactionFromMempool</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#lookupBalancesByAddresses">lookupBalancesByAddresses</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#setApiKey">setApiKey</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Requests.html#setUrl">setUrl</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-KeyManager.html">KeyManager</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="utils_address-utils.module_js.html">utils/address-utils.js</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_address-utils.module_js.html#~createAssetCode">createAssetCode</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_address-utils.module_js.html#~extractAddressesFromObj">extractAddressesFromObj</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_address-utils.module_js.html#~generatePubKeyHashAddress">generatePubKeyHashAddress</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_address-utils.module_js.html#~getDecimalByNetwork">getDecimalByNetwork</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_address-utils.module_js.html#~getHexByNetwork">getHexByNetwork</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_address-utils.module_js.html#~getValidNetworksList">getValidNetworksList</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_address-utils.module_js.html#~isValidAssetCode">isValidAssetCode</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_address-utils.module_js.html#~isValidMetadata">isValidMetadata</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_address-utils.module_js.html#~isValidNetwork">isValidNetwork</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_address-utils.module_js.html#~validateAddressesByNetwork">validateAddressesByNetwork</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html">utils/key-utils.js</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~create">create</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~decrypt">decrypt</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~deriveKey">deriveKey</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~dump">dump</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~encrypt">encrypt</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~generateKeystoreFilename">generateKeystoreFilename</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~getMAC">getMAC</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~isCipherAvailable">isCipherAvailable</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~keysEncodedFormat">keysEncodedFormat</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~marshal">marshal</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~recover">recover</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="utils_key-utils.module_js.html#~str2buf">str2buf</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#bramblRequest">bramblRequest</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#digestAndEncode">digestAndEncode</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#hashFunc">hashFunc</a></span></li>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><p><img src="https://github.com/Topl/BramblJS/workflows/build/badge.svg?branch=master" alt="build">
<img src="https://github.com/Topl/BramblJS/workflows/gh-pages%20docs/badge.svg?branch=master" alt="gh-pages docs">
<a href="https://badge.fury.io/js/bramblejs"><img src="https://badge.fury.io/js/bramblejs.svg" alt="npm version"></a></p>
<p>A NodeJS library to facilitate interaction with the Topl blockchain network. This server-side SDK is compliant with the Dion version of the Topl protocol as defined by the reference implementation, <a href="https://github.com/topl/bifrost">Bifrost client</a>.</p>
<h1>Installation</h1>
<p>To install from npm run <code>npm install --save brambljs</code> in your project directory.<br/></p>
<p>To install from source:</p>
<ul>
<li>Git clone using <code>git clone https://github.com/topl/BramblJS</code></li>
<li>Run <code>npm install</code> within the cloned repo to install all dependencies</li>
</ul>
<h1>Usage</h1>
<p>To create a minimal instance of BramblJS in your application, include the following commands:<br/></p>
<pre class="prettyprint source"><code>const BramblJS = require('brambljs');
const brambl = new BramblJS('PASSWORD')
</code></pre>
<p>This will create a new <code>Requests</code> instance targetting a local node running at <code>http://localhost:9085</code> and generate a new <code>KeyManager</code> instance for signing transactions, using Curve25519 and encrypted with <code>PASSWORD</code></p>
<p>BramblJS provides the following modules:</p>
<ul>
<li><code>Brambl</code> - primary module that provides high-level capabilities and access to</li>
<li><code>Requests</code> - sub-module for sending json-rpc requests to a specified chain provider.</li>
<li><code>KeyManager</code> - sub-module that provides functions for creating, importing, and exporting Bifrost compatible keyfiles.</li>
<li><code>Hash</code> - utility to recreates hashes calculated in Bifrost</li>
</ul>
<p>A brief overview of each module is given below but for a detailed descriptions of all available methods, please visit https://brambljs.docs.topl.co</p>
<h2>Brambl</h2>
<p>A helper library for interacting with the Topl protocol. Requests to the API layer of a chain provider conform to JSON-RPC standards and are managed by the Requests module. Key Management conforms to the Dion specification of the Topl protocol as implemented in the reference client Bifrost v1.0.0.</p>
<p>Transactions may be issued using the method <code>brambl.transaction</code> following instantiation of the class. In summary, a transaction is implemented by:</p>
<ol>
<li>Requesting a prototype transaction from a specified network provider (i.e Topl Torus service or local private testnet)</li>
<li>Signing the raw transaction bytes using the keyfile in the <code>KeyManager</code> instance.</li>
<li>Sending the fully formed transaction to the <code>broadcastTx</code> method available in the <code>Requests</code> module.</li>
</ol>
<p>After issuance, the <code>pollTx</code> method may be used to begin polling the chain provider to determine the status of the newly issued transaction.</p>
<h2>Requests</h2>
<p>The <code>Requests</code> module is compliant with Bifrost's JSON-RPC interface documented at https://topl-rpc.docs.topl.co <br/>
A new JSON-RPC interface class may be instantiated by <br/></p>
<pre class="prettyprint source"><code>const requests = BramblJS.Requests();
</code></pre>
<p>By default requests will be sent to <code>http://localhost:9085</code>. This is the standard address and API port that Bifrost listens on when launched locally. All of the methods available in this module are asynchronous and will return <code>Promises</code> that must be handled using <code>async/await</code> structures or <code>.then()</code>. For example:</p>
<pre class="prettyprint source"><code>requests.chainInfo().then(console.log).catch(console.error)
</code></pre>
<h3>Brambl-layer API key protection</h3>
<p>By default, Bifrost uses an API key of <code>topl_the_world!</code> to validate requests on locally running test nets. If you are planning to use the Topl Torus service for servicing API requests, you will need to register for an API key from Torus and subsequently use this value in the constructor of the Brambl layer object. Standard best practices for protecting API keys should be followed in this case (i.e. saving variables in .ENV or config files that are not shared with version control).</p>
<h2>KeyManager</h2>
<p>The <code>KeyManager</code> module is compliant with Bifrost's Gjallarhorn Key Manager service and provides an straightforward interface for creating new keyfiles as well as creating and verifying signatures on transactions. New encrypted keyfiles are generated using Curve25519 key pairs and are encrypted using an AES-256 cipher with a user-specified password. All data within the keyfile is encoded using Base58.<br/></p>
<p>A new  <code>KeyManager</code> may be created directly using<br/></p>
<pre class="prettyprint source"><code>const keyManager = BramblJS.KeyManager('PASSWORD')
</code></pre>
<p>where <code>'PASSWORD'</code> is the user provided encryption password for the keyfile.</p>
<h1>Examples</h1>
<p>Below are examples for using the BramblJS library with a private testnet running on your localhost. Please consult the <a href="https://github.com/topl/bifrost">Bifrost documentation</a> for further instructions on deploying a local private testnet.</p>
<h3>Retrieving the timestamp of the latest block</h3>
<pre class="prettyprint source"><code>BramblJS.Requests().chainInfo().then(x => {
    const timestamp = new Date(x.result.bestBlock.timestamp)
    const blockHeight = x.result.height
    console.log('Block #' + blockHeight + ' forged at ' + timestamp)
})
</code></pre>
<h3>Importing a keyfile to a KeyManager instance</h3>
<pre class="prettyprint source"><code>const keyManager = BramblJS.KeyManager({ keyPath: '/path/to/file', password: 'encryption_password' })
</code></pre>
<h3>Issuing a <code>createAsset</code> transaction</h3>
<pre class="prettyprint source"><code>const brambl = new BramblJS('test')

const createParams = {
    issuer: brambl.keyManager.pk,
    assetCode: &quot;test-&quot; + Date.now(),
    recipient: brambl.keyManager.pk,
    amount: 1,
    fee: 0
};

brambl.transaction('createAssetsPrototype', createParams).then(console.log)
</code></pre>
<h3>Creating and polling a <code>createAsset</code> transaction</h3>
<pre class="prettyprint source"><code>const brambl = new BramblJS('test')

const createParams = {
    issuer: brambl.keyManager.pk,
    assetCode: &quot;test-&quot; + Date.now(),
    recipient: brambl.keyManager.pk,
    amount: 1,
    fee: 0
};

brambl.transaction('createAssetsPrototype', createParams)
    .then(res => { console.log('Unconfirmed transaction'); console.log(res); return res })
    .then(res => brambl.pollTx(res.result.txHash))
    .then(res => { console.log('\nConfirmed transaction'); console.log(res) })
    .catch(console.log)
</code></pre>
<h1>Testing</h1>
<ul>
<li>Run linter before committing any code or creating a PR: <code>npm run lint</code></li>
<li>You can easily apply some fixes (make sure you review them after): <code>npm run lint:fix</code></li>
<li>Run only unit tests (uses mocha, chai and sinon): <code>npm run test:it</code></li>
<li>Run only end to end (e2e) tests (uses mocha, chai): <code>npm run test:e2e</code></li>
<li>Run both unit testing and linter: <code>npm run test</code></li>
<li>Run all tests: <code>npm run test:all</code></li>
</ul>
<h1>License</h1>
<p>BramblJS is licensed under the <a href="https://www.mozilla.org/en-US/MPL/2.0">Mozilla Public License version 2.0 (MPL 2.0)</a>. A copy of this license may be found <a href="../LICENSE.md">here</a></p></article>
    </section>






</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Thu Mar 04 2021 19:09:22 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>